const fs = require("node:fs");

const recipes = JSON.parse(fs.readFileSync("data.json", "utf8"));

const categories = recipes.reduce((acc, recipe) => {
  if (!acc.includes(recipe.category)) {
    acc.push(recipe.category);
  }
  return acc;
}, []);

const javascriptFileContents = `// This file is generated by a script. Do not edit.

/**
 * Get a list of recipes.
 * @returns {Object[]} a list of recipes
 */
function getRecipes() {
  return JSON.parse("${JSON.stringify(recipes).replaceAll('"', '\\"')}");
}
  
/**
 * Get a list of categories.
 * @returns {string[]} a list of categories
 */
function getCategories() {
  return JSON.parse("${JSON.stringify(categories).replaceAll('"', '\\"')}");
}

if (typeof module !== 'undefined') {
  module.exports = {
    getRecipes,
    getCategories
  }
}
`;

fs.writeFileSync(`../src/js/data.js`, javascriptFileContents, "utf8");
